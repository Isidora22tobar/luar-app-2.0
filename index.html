<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Luar 🌌</title>

<!-- PWA meta -->
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#cfa3f7">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title" content="Luar 🌌">
<link rel="apple-touch-icon" href="icon-192.png">

<style>
body {
  margin:0; font-family:'Segoe UI',sans-serif;
  background: linear-gradient(160deg,#d9c1f2,#e6d4f8);
  color:#333; text-align:center; position:relative;
}
.screen { display:none; padding:2em; position:relative; min-height:100vh; }
.screen.active { display:block; }
h1,h2 { margin:0.5em 0; }
button {
  padding:20px 40px; margin:12px auto; border:none; border-radius:20px;
  cursor:pointer; font-size:1.3em; box-shadow:0 4px 12px rgba(0,0,0,0.2);
  display:block; transition:0.2s; background:#cfa3f7; color:#fff;
}
button:hover { transform:scale(1.05); }
#circle {
  width:150px; height:150px; border-radius:50%; background:#d1aefc;
  margin:50px auto; display:flex; align-items:center; justify-content:center;
  font-weight:bold; font-size:1.4em; color:#333; transition: all 2s ease-in-out;
}
.chat-box {
  height:300px; overflow-y:auto; border:1px solid #ccc; border-radius:15px;
  padding:10px; background:#fff; margin-bottom:12px; text-align:left;
}
.chat-msg { margin:5px 0; padding:10px 14px; border-radius:20px; max-width:70%; display:inline-block; clear:both;}
.chat-user{background:#b18cff; color:#fff; float:right;}
.chat-luar{background:#e0c3fc; color:#333; float:left;}
input[type=text]{width:70%; padding:14px; border-radius:15px; border:1px solid #ccc; margin-right:5px;}
.back-arrow {
  position:absolute; top:15px; left:15px; font-size:2em; cursor:pointer;
  color:#fff; background: rgba(200,163,247,0.8); border-radius:50%;
  width:50px; height:50px; display:flex; align-items:center; justify-content:center;
  box-shadow:0 4px 10px rgba(0,0,0,0.2); transition:0.2s; z-index:100;
}
.back-arrow:hover { transform:scale(1.1); }
</style>
</head>
<body>

<div id="homeScreen" class="screen active">
<h1>Luar 🌌</h1>
<p>Mental & Physical Well-being</p>
<div id="buttons"></div>
</div>

<div id="habitsScreen" class="screen"></div>
<div id="moodScreen" class="screen"></div>
<div id="breathingScreen" class="screen"></div>
<div id="chatScreen" class="screen"></div>
<div id="challengeScreen" class="screen"></div>
<div id="statsScreen" class="screen"></div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script>
// ---------- Screen management ----------
function showScreen(id){
  document.querySelectorAll(".screen").forEach(s=>s.classList.remove("active"));
  document.getElementById(id).classList.add("active");
}

// ---------- Home buttons ----------
const screens=[
  {name:"Daily Habits", id:"habitsScreen"},
  {name:"Mood Tracker", id:"moodScreen"},
  {name:"Breathing Exercise", id:"breathingScreen"},
  {name:"Motivational Chat", id:"chatScreen"},
  {name:"Daily Challenge", id:"challengeScreen"},
  {name:"Statistics", id:"statsScreen"}
];
const buttonsContainer=document.getElementById("buttons");
screens.forEach(s=>{
  let btn=document.createElement("button");
  btn.textContent=s.name;
  btn.onclick=()=>{ showScreen(s.id); renderScreen(s.id); }
  buttonsContainer.appendChild(btn);
});

// ---------- LocalStorage helpers ----------
function saveData(key,value){let arr=JSON.parse(localStorage.getItem(key)||"[]"); arr.push({value:value,date:new Date().toISOString()}); localStorage.setItem(key,JSON.stringify(arr));}
function getData(key){return JSON.parse(localStorage.getItem(key)||"[]");}

// ---------- Back arrow ----------
function addBackArrow(screenId){
  const screen = document.getElementById(screenId);
  let arrow = document.createElement("div");
  arrow.className = "back-arrow";
  arrow.innerHTML = "&#8592;";
  arrow.onclick = ()=>showScreen("homeScreen");
  screen.appendChild(arrow);
}

// ---------- Render content ----------
function renderScreen(id){
  let screen=document.getElementById(id);
  screen.innerHTML=""; // limpiar pantalla
}
  if(id==="habitsScreen"){
    ["Drink Water 💧","Move 10 min 🏃","Deep Breathing 🌬","Sleep Well 😴"].forEach(h=>{
      let btn=document.createElement("button"); btn.textContent=h;
      btn.onclick=()=>{saveData("habits",h); alert(`Habit '${h}' saved!`);}
      screen.appendChild(btn);
    });
    addBackArrow(id);
  }

  if(id==="moodScreen"){
    ["😊 Good","😐 Okay","😔 Sad","😡 Angry","😰 Anxious","😴 Tired","😌 Relaxed","💪 Motivated"].forEach(m=>{
      let btn=document.createElement("button"); btn.textContent=m;
      btn.onclick=()=>{saveData("moods",m); alert(`Mood '${m}' saved!`);}
      screen.appendChild(btn);
    });
    addBackArrow(id);
  }

  if(id==="breathingScreen"){
    let circle=document.createElement("div"); circle.id="circle"; circle.textContent="Ready"; screen.appendChild(circle);
    let btn=document.createElement("button"); btn.textContent="Start Exercise"; screen.appendChild(btn);
    btn.onclick=()=>{
      let seq=["Inhale 🌬","Hold ✋","Exhale 🌊"];
      let sizes=[250,180,150]; let idx=0;
      function animate(){
        if(idx<seq.length){
          circle.textContent=seq[idx];
          circle.style.width=sizes[idx]+"px"; circle.style.height=sizes[idx]+"px";
          idx++; setTimeout(animate,2000);
        } else {
          circle.textContent="Done! 🌟"; circle.style.width="150px"; circle.style.height="150px";
        }
      } animate();
    }
    addBackArrow(id);
  }

  if(id==="chatScreen") {
    screen.innerHTML="<h2>Motivational Chat</h2>";
    let chatBox=document.createElement("div"); chatBox.className="chat-box"; screen.appendChild(chatBox);
    let input=document.createElement("input"); input.type="text"; screen.appendChild(input);
    let sendBtn=document.createElement("button"); sendBtn.textContent="Send"; screen.appendChild(sendBtn);

    sendBtn.onclick = ()=>{
      let msg=input.value.trim(); if(!msg) return; input.value="";
      addChat("You",msg);
      let r=simulatedResponse(msg); addChat("Luar",r);
    };

    function addChat(sender,msg){
      let p=document.createElement("p"); p.textContent=msg;
      p.className="chat-msg "+(sender==="You"?"chat-user":"chat-luar");
      chatBox.appendChild(p);
      chatBox.scrollTop=chatBox.scrollHeight;
      saveData("chat",`${sender}: ${msg}`);
    }

    const EMOTION_KEYWORDS = {
      sad:["sad","down","unhappy","lonely","depressed","blue","melancholy","gloomy"],
      angry:["angry","mad","frustrated","annoyed","irritated","upset"],
      happy:["happy","joy","excited","content","good","cheerful","glad"],
      tired:["tired","sleepy","exhausted","fatigued","weary"],
      anxious:["anxious","nervous","worried","stressed","tense"],
      bored:["bored"]
    }